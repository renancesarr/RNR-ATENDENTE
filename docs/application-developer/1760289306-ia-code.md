## 1. Contexto consumido
- `docs/application-developer/README.md` ✅
- `docs/application-developer/pre-flight.md` ✅
- `docs/application-developer/1760289215-ia-code.md` ✅
- `db/migrations/0003_fact_tables.sql` ✅
- `db/migrations/0007_metric_views.sql` ✅
- `docs/project-manager/github_issues_backlog_T001-T150.md` ✅

## 2. Objetivo da alteração
Criar função SQL (`fn_lead_estimated_value`) que calcule valor estimado do lead, conforme tarefa T-042.

## 3. Decisões e justificativas
- Caso já exista `lead_value` registrado em `fact_lead`, o valor é retornado diretamente.
- Caso contrário, o cálculo usa heurística baseada em mensagens inbound/outbound (peso 5/2) e aplica bônus de 10% para TTFR ≤ 60s.
- Função marcada como `STABLE` para permitir caching em uma mesma transação.

## 4. Implementação
- Arquivos tocados: `db/migrations/0008_lead_value_function.sql`, `docs/application-developer/pre-flight.md`.
- Estratégia de testes/validação: executar função manualmente após popular dados (não executado aqui).

## 5. Pontos que precisam de revisão humana
Revisar pesos e bônus com time de negócio; ajustar conforme validação real.

## 6. Follow-ups recomendados
- Criar testes SQL quando seeds estiverem disponíveis.
- Expor função via API/relatórios de valor do lead.
